<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creator Fees Tracker — FTX2.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-[#0b0f18] text-zinc-100">

  <!-- Background -->
  <div class="fixed inset-0 -z-10">
    <div class="absolute inset-0 bg-gradient-to-b from-[#101a2d] via-[#0b0f18] to-black"></div>
    <div class="absolute -top-40 left-1/2 -translate-x-1/2 h-[520px] w-[900px] rounded-full blur-3xl opacity-25 bg-cyan-500"></div>
  </div>

  <main class="max-w-5xl mx-auto px-4 py-10 md:py-14">

    <!-- HEADER -->
    <header class="flex items-center justify-between gap-4 flex-wrap">
      <div class="text-2xl md:text-3xl font-semibold tracking-wide">
        FTX2.0
      </div>

      <div class="flex gap-2 flex-wrap">
        <a href="/" class="btn">Back</a>

        <a
          href="https://pump.fun/profile/7F9pjqWa9rwhvT3FtW2pcsyRgsMd9tS4Z5zhauY36UAL?tab=creator-rewards"
          target="_blank"
          rel="noreferrer"
          class="btn"
        >
          Pump.fun Profile
        </a>
      </div>
    </header>

    <!-- TITLE -->
    <section class="mt-10 rounded-3xl bg-white/5 border border-white/10 p-7 md:p-10">
      <div class="text-xs text-zinc-400">TRACKER</div>
      <h1 class="mt-2 text-3xl md:text-4xl font-semibold">
        Creator Fees Tracker
      </h1>

      <p class="mt-3 text-sm text-zinc-400">
        Tracks Pump.fun creator rewards (USD total across tokens) + on-chain SOL balance.
      </p>

      <div class="mt-5 rounded-2xl bg-black/40 border border-white/10 p-4">
        <div class="text-xs text-zinc-400">CREATOR WALLET</div>
        <div class="mt-2 font-mono text-sm break-all text-zinc-200">
          7F9pjqWa9rwhvT3FtW2pcsyRgsMd9tS4Z5zhauY36UAL
        </div>
      </div>
    </section>

    <!-- USD TOTAL -->
    <section class="mt-8 rounded-3xl bg-white/5 border border-white/10 p-6">
      <div class="text-xs text-zinc-400">PUMP.FUN TOTAL (USD)</div>
      <div id="usdTotal" class="mt-2 text-4xl font-semibold">Loading…</div>
      <div id="usdUpdated" class="mt-2 text-xs text-zinc-500">Updated —</div>
    </section>

    <!-- SOL BALANCE -->
    <section class="mt-8 rounded-3xl bg-white/5 border border-white/10 p-6">
      <div class="text-xs text-zinc-400">WALLET SOL BALANCE</div>
      <div id="solBalance" class="mt-2 text-3xl font-semibold">Loading…</div>
      <div id="solUpdated" class="mt-2 text-xs text-zinc-500">Updated —</div>
    </section>

    <!-- FOOTER -->
    <footer class="mt-12 pt-6 border-t border-white/10 text-xs text-zinc-500">
      Not affiliated. Uses Pump.fun public endpoints and public Solana RPC.
    </footer>

  </main>

  <!-- Shared Button Style -->
  <style>
    .btn{
      padding: 0.5rem 1rem;
      border-radius: 0.75rem;
      background: rgba(0,0,0,0.65);
      border: 1px solid rgba(255,255,255,0.10);
      transition: all 180ms ease;
      display: inline-flex;
      align-items: center;
      gap: .5rem;
    }
    .btn:hover{
      background: rgba(34,211,238,0.12);
      border-color: rgba(34,211,238,0.35);
      color: #eaffff;
    }
  </style>

  <script>
    const WALLET = "7F9pjqWa9rwhvT3FtW2pcsyRgsMd9tS4Z5zhauY36UAL";
    const REFRESH_SECONDS = 15;

    function nowStr() {
      return new Date().toLocaleString();
    }

    async function fetchUsdTotal() {
      const usdEl = document.getElementById("usdTotal");
      const updatedEl = document.getElementById("usdUpdated");

      try {
        let page = 1;
        let totalUsd = 0;

        while (true) {
          const res = await fetch(
            `https://profile-api.pump.fun/balance/tokens/${WALLET}?page=${page}&size=50`
          );
          const data = await res.json();

          if (!data?.success) break;
          const tokens = data?.data?.tokens || [];
          if (!tokens.length) break;

          for (const tok of tokens) {
            if (typeof tok.value === "number") totalUsd += tok.value;
          }

          const totalPages = data?.pagination?.totalPages || page;
          if (page >= totalPages) break;
          page++;
        }

        usdEl.textContent =
          "$" + totalUsd.toLocaleString(undefined, { maximumFractionDigits: 2 });
        updatedEl.textContent = "Updated " + nowStr();
      } catch (err) {
        usdEl.textContent = "Error loading";
        updatedEl.textContent = "Updated —";
      }
    }

    async function fetchSolBalance() {
      const solEl = document.getElementById("solBalance");
      const updatedEl = document.getElementById("solUpdated");

      // Browser-friendly RPCs (CORS usually OK) + fallback
      const RPCS = [
        "https://solana-rpc.publicnode.com",
        "https://rpc.ankr.com/solana",
        "https://api.mainnet-beta.solana.com"
      ];

      for (const rpc of RPCS) {
        try {
          const res = await fetch(rpc, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              jsonrpc: "2.0",
              id: 1,
              method: "getBalance",
              params: [WALLET, { commitment: "confirmed" }]
            })
          });

          const data = await res.json();
          const lamports = data?.result?.value;

          if (typeof lamports === "number") {
            const sol = lamports / 1e9;
            solEl.textContent = sol.toFixed(4) + " SOL";
            updatedEl.textContent = "Updated " + nowStr();
            return;
          }
        } catch (e) {
          // try next rpc
        }
      }

      solEl.textContent = "Error loading";
      updatedEl.textContent = "Updated —";
    }

    async function refreshAll() {
      await Promise.all([fetchUsdTotal(), fetchSolBalance()]);
    }

    refreshAll();
    setInterval(refreshAll, REFRESH_SECONDS * 1000);
  </script>

</body>
</html>

